<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · FastaIO.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>FastaIO.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"><li><a class="toctext" href="#Installation-and-usage-1">Installation and usage</a></li><li><a class="toctext" href="#Introductory-notes-1">Introductory notes</a></li><li><a class="toctext" href="#The-FASTA-format-1">The FASTA format</a></li><li><a class="toctext" href="#The-sequence-storage-type-1">The sequence storage type</a></li><li><a class="toctext" href="#Reading-files-1">Reading files</a></li><li><a class="toctext" href="#Writing-files-1">Writing files</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="FastaIO.jl-—-FASTA-file-reader-and-writer-module-1" href="#FastaIO.jl-—-FASTA-file-reader-and-writer-module-1">FastaIO.jl — FASTA file reader and writer module</a></h1><p>This module provides ways to parse and write files in <a href="http://en.wikipedia.org/wiki/FASTA_format">FASTA format</a> in <a href="http://julialang.org">Julia</a>. It is designed to be lightweight and fast; the parsing method is inspired by <a href="http://lh3lh3.users.sourceforge.net/kseq.shtml">kseq.h</a>. It can read and write files on the fly, keeping only one entry at a time in memory, and it can read and write gzip-compressed files.</p><p>Here is a quick example for reading a file:</p><pre><code class="language-text">julia&gt; using FastaIO

julia&gt; FastaReader(&quot;somefile.fasta&quot;) do fr
           for (desc, seq) in fr
               println(&quot;$desc : $seq&quot;)
           end
       end</code></pre><p>And for writing:</p><pre><code class="language-text">julia&gt; using FastaIO

julia&gt; FastaWriter(&quot;somefile.fasta&quot;) do fw
           for s in [&quot;&gt;GENE1&quot;, &quot;GCATT&quot;, &quot;&gt;GENE2&quot;, &quot;ATTAGC&quot;]
               write(fw, s)
           end
       end</code></pre><h2><a class="nav-anchor" id="Installation-and-usage-1" href="#Installation-and-usage-1">Installation and usage</a></h2><p>To install the module, use Julia&#39;s package manager:</p><pre><code class="language-none">julia&gt; Pkg.add(&quot;FastaIO&quot;)</code></pre><p>Dependencies will be installed automatically. The module can then be loaded like any other Julia module:</p><pre><code class="language-none">julia&gt; using FastaIO</code></pre><h2><a class="nav-anchor" id="Introductory-notes-1" href="#Introductory-notes-1">Introductory notes</a></h2><p>For both reading and writing, there are quick methods to read/write all the data at once: <a href="#FastaIO.readfasta"><code>readfasta</code></a> and <a href="#FastaIO.writefasta-Tuple{AbstractString,Any}"><code>writefasta</code></a>. These, however, require all the data to be stored in memory at once, which may be impossible or undesirable for very large files. Therefore, for both reading and writing, the preferred way is actually to use specialized types, <a href="#FastaIO.FastaReader-Tuple{Union{AbstractString, IO}}"><code>FastaReader</code></a> and <a href="#FastaIO.FastaWriter"><code>FastaWriter</code></a>, which have the ability to process one entry (description + sequence data) at a time (the writer can actually process one char at a time); however, note that these two object types are not symmetric: the reader acts as an iterable object, while the writer behaves similarly to an <code>IO</code> stream.</p><h2><a class="nav-anchor" id="The-FASTA-format-1" href="#The-FASTA-format-1">The FASTA format</a></h2><p>The FASTA format which is assumed by this module is as follows:</p><ol><li>description lines must start with a <code>&gt;</code> character, and cannot be empty</li><li>only one description line per entry is allowed</li><li>all characters must be ASCII</li><li>whitespace is not allowed within sequence data (except for newlines) and at the beginning or end of the description</li><li>Empty lines are ignored (note however that lines containing whitespace will still trigger an error)</li></ol><p>When writing, description lines longer than 80 characters will trigger a warning message; sequence data is formatted in lines of 80 characters each; extra whitespace is silently discarded. No other restriction is put on the content of the sequence data, except that the <code>&gt;</code> character is forbidden.</p><p>When reading, almost no explicit checks are performed to test that the data actually conforms to these specifications.</p><h2><a class="nav-anchor" id="The-sequence-storage-type-1" href="#The-sequence-storage-type-1">The sequence storage type</a></h2><p>When reading FASTA files, the container type used to store the sequence data can be chosen (as an optional argument to <a href="#FastaIO.readfasta"><code>readfasta</code></a> or as a parametric type of <a href="#FastaIO.FastaReader-Tuple{Union{AbstractString, IO}}"><code>FastaReader</code></a>). The default is <code>String</code>, which is the most memory-efficient and the fastest; another performance-optimal option is <code>Vector{UInt8}</code>, which is a less friendly representation, but has the advantage of being mutable. Any other container <code>T</code> for which <code>convert(::Type{T}, ::Vector{UInt8})</code> is defined can be used (e.g. <code>Vector{Char}</code>, or a more specialized <code>Vector{AminoAcid}</code> if you use <a href="https://github.com/diegozea/BioSeq.jl">BioSeq</a>, but the conversion will generally slightly reduce the performance.</p><h2><a class="nav-anchor" id="Reading-files-1" href="#Reading-files-1">Reading files</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.readfasta" href="#FastaIO.readfasta"><code>FastaIO.readfasta</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">readfasta(file::Union{String,IO}, [sequence_type::Type = String])</code></pre><p>This function parses a whole FASTA file at once and stores it into memory. The result is a <code>Vector{Any}</code> whose elements are tuples consisting of <code>(description, sequence)</code>, where <code>description</code> is a <code>String</code> and <code>sequence</code> contains the sequence data, stored in a container type defined by the <code>sequence_type</code> optional argument (see <a href="#The-sequence-storage-type-1">The sequence storage type</a> section for more information).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.FastaReader-Tuple{Union{AbstractString, IO}}" href="#FastaIO.FastaReader-Tuple{Union{AbstractString, IO}}"><code>FastaIO.FastaReader</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">FastaReader{T}(file::Union{AbstractString,IO})</code></pre><p>This creates an object which is able to parse FASTA files, one entry at a time. <code>file</code> can be a plain text file or a gzip-compressed file (it will be autodetected from the content). The type <code>T</code> determines the output type of the sequences (see <a href="#The-sequence-storage-type-1">The sequence storage type</a> section for more information) and it defaults to <code>String</code>.</p><p>The data can be read out by iterating the <code>FastaReader</code> object:</p><pre><code class="language-julia">for (name, seq) in FastaReader(&quot;somefile.fasta&quot;)
    # do something with name and seq
end</code></pre><p>As shown, the iterator returns a tuple containing the description (always a <code>String</code>) and the data (whose type is set when creating the <code>FastaReader</code> object (e.g. <code>FastaReader{Vector{UInt8}}(filename)</code>).</p><p>The <code>FastaReader</code> type has a field <code>num_parsed</code> which contains the number of entries parsed so far.</p><p>Other ways to read out the data are via the <a href="#FastaIO.readentry"><code>readentry</code></a> and <a href="#FastaIO.readfasta"><code>readfasta</code></a> functions.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.FastaReader-Tuple{Function,AbstractString}" href="#FastaIO.FastaReader-Tuple{Function,AbstractString}"><code>FastaIO.FastaReader</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">FastaReader(f::Function, filename::AbstractString, [sequence_type::Type = String])</code></pre><p>This format of the constructor is useful for do-notation, i.e.:</p><pre><code class="language-julia">FastaReader(filename) do fr
    # read out the data from fr, e.g.
    for (name, seq) in fr
        # do something with name and seq
    end
end</code></pre><p>which ensures that the <a href="#Base.close-Tuple{FastaReader}"><code>close</code></a> function is called and is thus recommended (otherwise the file is closed by the garbage collector when the <code>FastaReader</code> object goes out of scope).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.readentry" href="#FastaIO.readentry"><code>FastaIO.readentry</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">readentry(fr::FastaReader)</code></pre><p>This function can be used to read entries one at a time:</p><pre><code class="language-julia">fr = FastaReader(&quot;somefile.fasta&quot;)
name, seq = readentry(fr)</code></pre><p>See also the <a href="#Base.eof-Tuple{FastaReader}"><code>eof</code></a> function.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.rewind-Tuple{FastaReader}" href="#FastaIO.rewind-Tuple{FastaReader}"><code>FastaIO.rewind</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">rewind(fr::FastaReader)</code></pre><p>This function rewinds the reader, so that it can restart the parsing again without closing and re-opening it. It also resets the value of the <code>num_parsed</code> field.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.eof-Tuple{FastaReader}" href="#Base.eof-Tuple{FastaReader}"><code>Base.eof</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">eof(fr::FastaReader)</code></pre><p>This function extends <code>Base.eof</code> and tests for end-of-file condition; it is useful when using <a href="#FastaIO.readentry"><code>readentry</code></a>:</p><pre><code class="language-julia">fr = FastaReader(&quot;somefile.fasta&quot;)
while !eof(fr)
   name, seq = readentry(fr)
   # do something
end
close(fr)</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.close-Tuple{FastaReader}" href="#Base.close-Tuple{FastaReader}"><code>Base.close</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">close(fr::FastaReader)</code></pre><p>This function extends <code>Base.close</code> and closes the stream associated with the <code>FastaReader</code>; the reader must not be used any more after this function is called.</p></div></div></section><h2><a class="nav-anchor" id="Writing-files-1" href="#Writing-files-1">Writing files</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.writefasta-Tuple{AbstractString,Any}" href="#FastaIO.writefasta-Tuple{AbstractString,Any}"><code>FastaIO.writefasta</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">writefasta(filename::String, data, [mode::String = &quot;w&quot;])</code></pre><p>This function dumps data to a FASTA file, auto-formatting it so to follow the specifications detailed in the section titled <a href="#The-FASTA-format-1">The FASTA format</a>. The <code>data</code> can be anything which is iterable and which produces <code>(description, sequence)</code> tuples upon iteration, where the <code>description</code> must be convertible to a <code>String</code> and the <code>sequence</code> can be any iterable object which yields elements convertible to ASCII characters (e.g. a <code>String</code>, a <code>Vector{UInt8}</code> etc.).</p><p>Examples:</p><pre><code class="language-julia">writefasta(&quot;somefile.fasta&quot;, [(&quot;GENE1&quot;, &quot;GCATT&quot;), (&quot;GENE2&quot;, &quot;ATTAGC&quot;)])
writefasta(&quot;somefile.fasta&quot;, [&quot;GENE1&quot; =&gt; &quot;GCATT&quot;, &quot;GENE2&quot; =&gt; &quot;ATTAGC&quot;])</code></pre><p>If the <code>filename</code> ends with <code>.gz</code>, the result will be a gzip-compressed file.</p><p>The <code>mode</code> flag determines how the <code>filename</code> is open; use <code>&quot;a&quot;</code> to append the data to an existing file.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.writefasta-Tuple{IO,Any}" href="#FastaIO.writefasta-Tuple{IO,Any}"><code>FastaIO.writefasta</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">writefasta([io::IO = STDOUT], data)</code></pre><p>This version of the function writes to an already opened <code>IO</code> stream, defaulting to <code>STDOUT</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.FastaWriter" href="#FastaIO.FastaWriter"><code>FastaIO.FastaWriter</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">FastaWriter(filename::AbstractString, [mode::String = &quot;w&quot;])
FastaWriter([io::IO = STDOUT])
FastaWriter(f::Function, args...)</code></pre><p>This creates an object which is able to write formatted FASTA files which conform to the specifications detailed in the section titled <a href="#The-FASTA-format-1">The FASTA format</a>, via the <a href="#Base.write-Tuple{FastaWriter,Any}"><code>write</code></a> and <a href="#FastaIO.writeentry"><code>writeentry</code></a> functions.</p><p>The third form allows to use do-notation:</p><pre><code class="language-julia">FastaWriter(&quot;somefile.fasta&quot;) do fw
    # write the file
end</code></pre><p>which is strongly recommended since it ensures that the <a href="#Base.close-Tuple{FastaReader}"><code>close</code></a> function is called at the end of writing: this is crucial, as failing to do so may result in incomplete files (this is done by the finalizer, so it will still happen automatically if the <code>FastaWriter</code> object goes out of scope and is garbage-collected, but there is no guarantee that this will happen if Julia exits).</p><p>If the <code>filename</code> ends with <code>.gz</code>, the result will be gzip-compressed.</p><p>The <code>mode</code> flag can be used to set the opening mode of the file; use <code>&quot;a&quot;</code> to append to an existing file.</p><p>The <code>FastaWriter</code> object has an <code>entry::Int</code> field which stores the number of the entry which is currently being written.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FastaIO.writeentry" href="#FastaIO.writeentry"><code>FastaIO.writeentry</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">writeentry(fw::FastaWriter, description::AbstractString, sequence)</code></pre><p>This function writes one entry to the FASTA file, following the specifications detailed in the section titled <a href="#The-FASTA-format-1">The FASTA format</a>. The <code>description</code> is without the initial <code>&#39;&gt;&#39;</code> character. The <code>sequence</code> can be any iterable object whose elements are convertible to ASCII characters.</p><p>Example:</p><pre><code class="language-julia">FastaWriter(&quot;somefile.fasta&quot;) do fw
    for (desc,seq) in [(&quot;GENE1&quot;, &quot;GCATT&quot;), (&quot;GENE2&quot;, &quot;ATTAGC&quot;)]
        writeentry(fw, desc, seq)
    end
end</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.write-Tuple{FastaWriter,Any}" href="#Base.write-Tuple{FastaWriter,Any}"><code>Base.write</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">write(fw::FastaWriter, item)</code></pre><p>This function extends <code>Base.write</code> and streams items to a FASTA file, which will be formatted according to the specifications detailed in the section titled <a href="#The-FASTA-format-1">The FASTA format</a>.</p><p>When using this method, description lines are marked by the fact that they begin with a <code>&#39;&gt;&#39;</code> character; anything else is assumed to be part of the sequence data.</p><p>If <code>item</code> is a <code>Vector</code>, <code>write</code> will be called iteratively over it; if it is a <code>String</code>, a newline will be appended to it and it will be dumped. For example the following code:</p><pre><code class="language-julia">FastaWriter(&quot;somefile.fasta&quot;) do fw
    for s in [&quot;&gt;GENE1&quot;, &quot;GCA&quot;, &quot;TTT&quot;, &quot;&gt;GENE2&quot;, &quot;ATTAGC&quot;]
        write(fw, s)
    end
end</code></pre><p>will result in the file:</p><pre><code class="language-text">&gt;GENE1
GCATTT
&gt;GENE2
ATTAGC</code></pre><p>If <code>item</code> is not a <code>Vector</code> nor a <code>String</code>, it must be convertible to an ASCII character, and it will be piped into the file. For example the following code:</p><pre><code class="language-julia">data = &quot;&quot;&quot;
  &gt;GENE1
  GCA
  TTT
  &gt;GENE2
  ATT
  AGC
  &quot;&quot;&quot;

FastaWriter(&quot;somefile.fasta&quot;) do fw
    for ch in data
        write(fw, ch)
    end
end</code></pre><p>will result in the same file as above.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.close-Tuple{FastaWriter}" href="#Base.close-Tuple{FastaWriter}"><code>Base.close</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">close(fw::FastaWriter)</code></pre><p>This function extends <code>Base.close</code> and it should always be explicitly used for finalizing the <code>FastaWriter</code> once the writing has finished, unless the do-notation is used when creating it.</p></div></div></section><footer><hr/></footer></article></body></html>
