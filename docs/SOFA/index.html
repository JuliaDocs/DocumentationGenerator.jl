<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · SOFA.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SOFA.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Home</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Home</a></li></ul></nav><hr/><div id="topbar"><span>Home</span><a class="fa fa-bars" href="#"></a></div></header><p>Package doesn&#39;t contain Documenter docs.</p><p>Docs automatically generated by juliadocs.org</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauASTROM" href="#SOFA.iauASTROM"><code>SOFA.iauASTROM</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Star-independent astrometry parameters</p><p>Note:     - Vectors eb, eh, em and v are all with respect to BCRS axes.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauLDBODY" href="#SOFA.iauLDBODY"><code>SOFA.iauLDBODY</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Body parameters for light deflection</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauA2af-Tuple{Int64,Real}" href="#SOFA.iauA2af-Tuple{Int64,Real}"><code>SOFA.iauA2af</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Decompose radians into degrees, arcminutes, arcseconds, fraction. This function is part of the International Astronomical Union&#39;s SOFA (Standards Of Fundamental Astronomy) software collection.</p><p>Status:  vector/matrix support function.</p><p>Given:    ndp     int     resolution (Note 1)    angle   double  angle in radians</p><p>Returned:    sign    char    &#39;+&#39; or &#39;-&#39;    idmsf   int[4]  degrees, arcminutes, arcseconds, fraction</p><p>Called:    iauD2tf      decompose days to hms</p><p>Notes:     1. The argument ndp is interpreted as follows:     ndp         resolution      :      ...0000 00 00     -7         1000 00 00     -6          100 00 00     -5           10 00 00     -4            1 00 00     -3            0 10 00     -2            0 01 00     -1            0 00 10      0            0 00 01      1            0 00 00.1      2            0 00 00.01      3            0 00 00.001      :            0 00 00.000...</p><pre><code class="language-none">2. The largest positive useful value for ndp is determined by the</code></pre><p>size of angle, the format of doubles on the target platform, and    the risk of overflowing idmsf[3].  On a typical platform, for    angle up to 2pi, the available floating-point precision might    correspond to ndp=12.  However, the practical limit is typically    ndp=9, set by the capacity of a 32-bit int, or ndp=4 if int is    only 16 bits.</p><pre><code class="language-none">3. The absolute value of angle may exceed 2pi.  In cases where it</code></pre><p>does not, it is up to the caller to test for and handle the    case where angle is very nearly 2pi and rounds up to 360 degrees,    by testing for idmsf[0]=360 and setting idmsf[0-3] to zero.</p><p>This revision:  2013 June 18</p><p>SOFA release 2018-01-30</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauA2tf-Tuple{Int64,Real}" href="#SOFA.iauA2tf-Tuple{Int64,Real}"><code>SOFA.iauA2tf</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Decompose radians into hours, minutes, seconds, fraction.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards Of Fundamental Astronomy) software collection.</p><p>Status:  vector/matrix support function.</p><p>Given:    ndp     int     resolution (Note 1)    angle   double  angle in radians</p><p>Returned:    sign    char    &#39;+&#39; or &#39;-&#39;    ihmsf   int[4]  hours, minutes, seconds, fraction</p><p>Called:    iauD2tf      decompose days to hms</p><p>Notes:</p><pre><code class="language-none">1. The argument ndp is interpreted as follows:
    ndp         resolution
     :      ...0000 00 00
    -7         1000 00 00
    -6          100 00 00
    -5           10 00 00
    -4            1 00 00
    -3            0 10 00
    -2            0 01 00
    -1            0 00 10
     0            0 00 01
     1            0 00 00.1
     2            0 00 00.01
     3            0 00 00.001
     :            0 00 00.000...

2. The largest positive useful value for ndp is determined by the
size of angle, the format of doubles on the target platform, and
the risk of overflowing ihmsf[3].  On a typical platform, for
angle up to 2pi, the available floating-point precision might
correspond to ndp=12.  However, the practical limit is typically
ndp=9, set by the capacity of a 32-bit int, or ndp=4 if int is
only 16 bits.

3. The absolute value of angle may exceed 2pi.  In cases where it
does not, it is up to the caller to test for and handle the
case where angle is very nearly 2pi and rounds up to 24 hours,
by testing for ihmsf[0]=24 and setting ihmsf[0-3] to zero.</code></pre><p>This revision:  2013 July 31</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAb-Tuple{Array{#s23,1} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real,Real,Float64}" href="#SOFA.iauAb-Tuple{Array{#s23,1} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real,Real,Float64}"><code>SOFA.iauAb</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Apply aberration to transform natural direction into proper direction.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    pnat    double[3]   natural direction to the source (unit vector)    v       double[3]   observer barycentric velocity in units of c    s       double      distance between the Sun and the observer (au)    bm1     double      sqrt(1-|v|^2): reciprocal of Lorenz factor</p><p>Returned:    ppr     double[3]   proper direction to source (unit vector)</p><p>Notes:</p><ol><li>The algorithm is based on Expr. (7.40) in the Explanatory</li></ol><p>Supplement (Urban &amp; Seidelmann 2013), but with the following    changes:       - Rigorous rather than approximate normalization is applied.       -The gravitational potential term from Expr. (7) in       Klioner (2003) is added, taking into account only the Sun&#39;s       contribution.  This has a maximum effect of about       0.4 microarcsecond.</p><ol><li>In almost all cases, the maximum accuracy will be limited by the</li></ol><p>supplied velocity.  For example, if the SOFA iauEpv00 function is    used, errors of up to 5 microarcseconds could occur.</p><p>References:</p><ul><li>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to</li></ul><p>the Astronomical Almanac, 3rd ed., University Science Books    (2013).</p><ul><li>Klioner, Sergei A., &quot;A practical relativistic model for micro-</li></ul><p>arcsecond astrometry in space&quot;, Astr. J. 125, 1580-1597 (2003).</p><p>Called:    iauPdp       scalar product of two p-vectors</p><p>This revision:   2013 October 9</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAe2hd-Tuple{Real,Real,Real}" href="#SOFA.iauAe2hd-Tuple{Real,Real,Real}"><code>SOFA.iauAe2hd</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Horizon to equatorial coordinates:  transform azimuth and altitude to hour angle and declination.</p><p>Given:    az       double       azimuth    el       double       altitude (informally, elevation)    phi      double       site latitude</p><p>Returned:    ha       double       hour angle (local)    dec      double       declination</p><p>Notes:</p><ol><li><p>All the arguments are angles in radians.</p></li><li><p>The sign convention for azimuth is north zero, east +pi/2.</p></li><li><p>HA is returned in the range +/-pi.  Declination is returned in</p></li></ol><p>the range +/-pi/2.</p><ol><li>The latitude phi is pi/2 minus the angle between the Earth&#39;s</li></ol><p>rotation axis and the adopted zenith.  In many applications it    will be sufficient to use the published geodetic latitude of the    site.  In very precise (sub-arcsecond) applications, phi can be    corrected for polar motion.</p><ol><li>The azimuth az must be with respect to the rotational north pole,</li></ol><p>as opposed to the ITRS pole, and an azimuth with respect to north    on a map of the Earth&#39;s surface will need to be adjusted for    polar motion if sub-arcsecond accuracy is required.</p><ol><li>Should the user wish to work with respect to the astronomical</li></ol><p>zenith rather than the geodetic zenith, phi will need to be    adjusted for deflection of the vertical (often tens of    arcseconds), and the zero point of ha will also be affected.</p><ol><li>The transformation is the same as Ve = Ry(phi-pi/2)<em>Rz(pi)</em>Vh,</li></ol><p>where Ve and Vh are lefthanded unit vectors in the (ha,dec) and    (az,el) systems respectively and Rz and Ry are rotations about    first the z-axis and then the y-axis.  (n.b. Rz(pi) simply    reverses the signs of the x and y components.)  For efficiency,    the algorithm is written out rather than calling other utility    functions.  For applications that require even greater    efficiency, additional savings are possible if constant terms    such as functions of latitude are computed once and for all.</p><ol><li>Again for efficiency, no range checking of arguments is carried</li></ol><p>out.</p><p>Last revision:   2017 September 12</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAf2a-Tuple{Char,Int64,Int64,Real}" href="#SOFA.iauAf2a-Tuple{Char,Int64,Int64,Real}"><code>SOFA.iauAf2a</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Convert degrees, arcminutes, arcseconds to radians.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:     s         char    sign:  &#39;-&#39; = negative, otherwise positive     ideg      int     degrees     iamin     int     arcminutes     asec      double  arcseconds</p><p>Returned:     rad       double  angle in radians</p><p>Returned (function value):     int status:  0 = OK                  1 = ideg outside range 0-359                  2 = iamin outside range 0-59                  3 = asec outside range 0-59.999... Notes:     1. The result is computed even if any of the range checks fail.</p><pre><code class="language-none">2. Negative ideg, iamin and/or asec produce a warning status, but
the absolute value is used in the conversion.

3. If there are multiple errors, the status value reflects only the
first, the smallest taking precedence.

This revision:  2013 June 18</code></pre><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAnp-Tuple{Real}" href="#SOFA.iauAnp-Tuple{Real}"><code>SOFA.iauAnp</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Normalize angle into the range 0 &lt;= a &lt; 2pi.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards Of Fundamental Astronomy) software collection.</p><p>Status:  vector/matrix support function.</p><p>Given:    a        double     angle (radians)</p><p>Returned (function value):    double     angle in range 0-2pi</p><p>This revision:  2013 June 18</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAnpm-Tuple{Real}" href="#SOFA.iauAnpm-Tuple{Real}"><code>SOFA.iauAnpm</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Normalize angle into the range -pi &lt;= a &lt; +pi.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards Of Fundamental Astronomy) software collection.</p><p>Status:  vector/matrix support function.</p><p>Given:    a        double     angle (radians)</p><p>Returned (function value):    double     angle in range +/-pi</p><p>This revision:  2013 June 18</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauApcg-Tuple{Real,Real,Array{#s23,2} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real}" href="#SOFA.iauApcg-Tuple{Real,Real,Array{#s23,2} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real}"><code>SOFA.iauApcg</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>For a geocentric observer, prepare star-independent astrometry parameters for transformations between ICRS and GCRS coordinates. The Earth ephemeris is supplied by the caller.</p><p>The parameters produced by this function are required in the parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:     date1  double       TDB as a 2-part...     date2  double       ...Julian Date (Note 1)     ebpv   double[2][3] Earth barycentric pos/vel (au, au/day)     ehp    double[3]    Earth heliocentric position (au)</p><p>Returned:     astrom iauASTROM*   star-independent astrometry parameters:      pmt    double       PM time interval (SSB, Julian years)      eb     double[3]    SSB to observer (vector, au)      eh     double[3]    Sun to observer (unit vector)      em     double       distance from Sun to observer (au)      v      double[3]    barycentric observer velocity (vector, c)      bm1    double       sqrt(1-|v|^2): reciprocal of Lorenz factor      bpn    double[3][3] bias-precession-nutation matrix      along  double       unchanged      xpl    double       unchanged      ypl    double       unchanged      sphi   double       unchanged      cphi   double       unchanged      diurab double       unchanged      eral   double       unchanged      refa   double       unchanged      refb   double       unchanged</p><p>Notes:     1. The TDB date date1+date2 is a Julian Date, apportioned in any     convenient way between the two arguments.  For example,     JD(TDB)=2450123.7 could be expressed in any of these ways, among     others:</p><pre><code class="language-none">        date1          date2

     2450123.7           0.0       (JD method)
     2451545.0       -1421.3       (J2000 method)
     2400000.5       50123.2       (MJD method)
     2450123.5           0.2       (date &amp; time method)

The JD method is the most natural and convenient to use in cases
where the loss of several decimal digits of resolution is
acceptable.  The J2000 method is best matched to the way the
argument is handled internally and will deliver the optimum
resolution.  The MJD method and the date &amp; time methods are both
good compromises between resolution and convenience.  For most
applications of this function the choice will not be at all
critical.

TT can be used instead of TDB without any significant impact on
accuracy.

2. All the vectors are with respect to BCRS axes.

3. This is one of several functions that inserts into the astrom
structure star-independent parameters needed for the chain of
astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.

The various functions support different classes of observer and
portions of the transformation chain:

      functions         observer        transformation

   iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS
   iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS
   iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed
   iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS
   iauAper iauAper13    terrestrial     update Earth rotation
   iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed

Those with names ending in &quot;13&quot; use contemporary SOFA models to
compute the various ephemerides.  The others accept ephemerides
supplied by the caller.

The transformation from ICRS to GCRS covers space motion,
parallax, light deflection, and aberration.  From GCRS to CIRS
comprises frame bias and precession-nutation.  From CIRS to
observed takes account of Earth rotation, polar motion, diurnal
aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS
transformation), and atmospheric refraction.

4. The context structure astrom produced by this function is used by
iauAtciq* and iauAticq*.</code></pre><p>Called:     iauApcs      astrometry parameters, ICRS-GCRS, space observer</p><p>This revision:   2013 October 9</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauApcg13-Tuple{Real,Real}" href="#SOFA.iauApcg13-Tuple{Real,Real}"><code>SOFA.iauApcg13</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>For a geocentric observer, prepare star-independent astrometry parameters for transformations between ICRS and GCRS coordinates. The caller supplies the date, and SOFA models are used to predict the Earth ephemeris.</p><p>The parameters produced by this function are required in the parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    date1  double     TDB as a 2-part...    date2  double     ...Julian Date (Note 1)</p><p>Returned:    astrom iauASTROM* star-independent astrometry parameters:       pmt    double       PM time interval (SSB, Julian years)       eb     double[3]    SSB to observer (vector, au)       eh     double[3]    Sun to observer (unit vector)       em     double       distance from Sun to observer (au)       v      double[3]    barycentric observer velocity (vector, c)       bm1    double       sqrt(1-|v|^2): reciprocal of Lorenz factor       bpn    double[3][3] bias-precession-nutation matrix       along  double       unchanged       xpl    double       unchanged       ypl    double       unchanged       sphi   double       unchanged       cphi   double       unchanged       diurab double       unchanged       eral   double       unchanged       refa   double       unchanged       refb   double       unchanged</p><p>Notes:</p><ol><li>The TDB date date1+date2 is a Julian Date, apportioned in any</li></ol><p>convenient way between the two arguments.  For example,    JD(TDB)=2450123.7 could be expressed in any of these ways, among    others:</p><pre><code class="language-none">        date1          date2

     2450123.7           0.0       (JD method)
     2451545.0       -1421.3       (J2000 method)
     2400000.5       50123.2       (MJD method)
     2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases    where the loss of several decimal digits of resolution is    acceptable.  The J2000 method is best matched to the way the    argument is handled internally and will deliver the optimum    resolution.  The MJD method and the date &amp; time methods are both    good compromises between resolution and convenience.  For most    applications of this function the choice will not be at all    critical.</p><p>TT can be used instead of TDB without any significant impact on    accuracy.</p><ol><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>In cases where the caller wishes to supply his own Earth</p></li></ol><p>ephemeris, the function iauApcg can be used instead of the present    function.</p><ol><li>This is one of several functions that inserts into the astrom</li></ol><p>structure star-independent parameters needed for the chain of    astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and    portions of the transformation chain:</p><pre><code class="language-none">      functions         observer        transformation

   iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS
   iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS
   iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed
   iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS
   iauAper iauAper13    terrestrial     update Earth rotation
   iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed</code></pre><p>Those with names ending in &quot;13&quot; use contemporary SOFA models to    compute the various ephemerides.  The others accept ephemerides    supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion,    parallax, light deflection, and aberration.  From GCRS to CIRS    comprises frame bias and precession-nutation.  From CIRS to    observed takes account of Earth rotation, polar motion, diurnal    aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS    transformation), and atmospheric refraction.</p><ol><li>The context structure astrom produced by this function is used by</li></ol><p>iauAtciq* and iauAticq*.</p><p>Called:      iauEpv00     Earth position and velocity      iauApcg      astrometry parameters, ICRS-GCRS, geocenter</p><p>This revision:   2013 October 9</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauApci-Tuple{Real,Real,Array{#s23,2} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real,Real,Real,Real}" href="#SOFA.iauApci-Tuple{Real,Real,Array{#s23,2} where #s23&lt;:Real,Array{#s22,1} where #s22&lt;:Real,Real,Real,Real}"><code>SOFA.iauApci</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and geocentric CIRS coordinates.  The Earth ephemeris and CIP/CIO are supplied by the caller.</p><p>The parameters produced by this function are required in the parallax, light deflection, aberration, and bias-precession-nutation parts of the astrometric transformation chain.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:     date1  double       TDB as a 2-part...     date2  double       ...Julian Date (Note 1)     ebpv   double[2][3] Earth barycentric position/velocity (au, au/day)     ehp    double[3]    Earth heliocentric position (au)     x,y    double       CIP X,Y (components of unit vector)     s      double       the CIO locator s (radians)</p><p>Returned:     astrom iauASTROM*   star-independent astrometry parameters:         pmt    double       PM time interval (SSB, Julian years)         eb     double[3]    SSB to observer (vector, au)         eh     double[3]    Sun to observer (unit vector)         em     double       distance from Sun to observer (au)         v      double[3]    barycentric observer velocity (vector, c)         bm1    double       sqrt(1-|v|^2): reciprocal of Lorenz factor         bpn    double[3][3] bias-precession-nutation matrix         along  double       unchanged         xpl    double       unchanged         ypl    double       unchanged         sphi   double       unchanged         cphi   double       unchanged         diurab double       unchanged         eral   double       unchanged         refa   double       unchanged         refb   double       unchanged</p><p>Notes:</p><pre><code class="language-none">1. The TDB date date1+date2 is a Julian Date, apportioned in any
convenient way between the two arguments.  For example,
JD(TDB)=2450123.7 could be expressed in any of these ways, among
others:

    date1          date2

    2450123.7           0.0       (JD method)
    2451545.0       -1421.3       (J2000 method)
    2400000.5       50123.2       (MJD method)
    2450123.5           0.2       (date &amp; time method)

The JD method is the most natural and convenient to use in cases
where the loss of several decimal digits of resolution is
acceptable.  The J2000 method is best matched to the way the
argument is handled internally and will deliver the optimum
resolution.  The MJD method and the date &amp; time methods are both
good compromises between resolution and convenience.  For most
applications of this function the choice will not be at all
critical.

TT can be used instead of TDB without any significant impact on
accuracy.

2. All the vectors are with respect to BCRS axes.

3. In cases where the caller does not wish to provide the Earth
ephemeris and CIP/CIO, the function iauApci13 can be used instead
of the present function.  This computes the required quantities
using other SOFA functions.

4. This is one of several functions that inserts into the astrom
structure star-independent parameters needed for the chain of
astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.

The various functions support different classes of observer and
portions of the transformation chain:

    functions         observer        transformation

iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS
iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS
iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed
iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS
iauAper iauAper13    terrestrial     update Earth rotation
iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed

Those with names ending in &quot;13&quot; use contemporary SOFA models to
compute the various ephemerides.  The others accept ephemerides
supplied by the caller.

The transformation from ICRS to GCRS covers space motion,
parallax, light deflection, and aberration.  From GCRS to CIRS
comprises frame bias and precession-nutation.  From CIRS to
observed takes account of Earth rotation, polar motion, diurnal
aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS
transformation), and atmospheric refraction.

5. The context structure astrom produced by this function is used by
iauAtciq* and iauAticq*.</code></pre><p>Called:     iauApcg      astrometry parameters, ICRS-GCRS, geocenter     iauC2ixys    celestial-to-intermediate matrix, given X,Y and s</p><p>This revision:   2013 September 25</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauApci13-Tuple{Real,Real}" href="#SOFA.iauApci13-Tuple{Real,Real}"><code>SOFA.iauApci13</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and geocentric CIRS coordinates.  The caller supplies the date, and SOFA models are used to predict the Earth ephemeris and CIP/CIO.</p><p>The parameters produced by this function are required in the parallax, light deflection, aberration, and bias-precession-nutation parts of the astrometric transformation chain.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    date1  double      TDB as a 2-part...    date2  double      ...Julian Date (Note 1)</p><p>Returned:    astrom iauASTROM*  star-independent astrometry parameters:       pmt    double       PM time interval (SSB, Julian years)       eb     double[3]    SSB to observer (vector, au)       eh     double[3]    Sun to observer (unit vector)       em     double       distance from Sun to observer (au)       v      double[3]    barycentric observer velocity (vector, c)       bm1    double       sqrt(1-|v|^2): reciprocal of Lorenz factor       bpn    double[3][3] bias-precession-nutation matrix       along  double       unchanged       xpl    double       unchanged       ypl    double       unchanged       sphi   double       unchanged       cphi   double       unchanged       diurab double       unchanged       eral   double       unchanged       refa   double       unchanged       refb   double       unchanged    eo     double*     equation of the origins (ERA-GST)</p><p>Notes:</p><ol><li>The TDB date date1+date2 is a Julian Date, apportioned in any</li></ol><p>convenient way between the two arguments.  For example,    JD(TDB)=2450123.7 could be expressed in any of these ways, among    others:</p><pre><code class="language-none">     date1          date2

  2450123.7           0.0       (JD method)
  2451545.0       -1421.3       (J2000 method)
  2400000.5       50123.2       (MJD method)
  2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases    where the loss of several decimal digits of resolution is    acceptable.  The J2000 method is best matched to the way the    argument is handled internally and will deliver the optimum    resolution.  The MJD method and the date &amp; time methods are both    good compromises between resolution and convenience.  For most    applications of this function the choice will not be at all    critical.</p><p>TT can be used instead of TDB without any significant impact on    accuracy.</p><ol><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>In cases where the caller wishes to supply his own Earth</p></li></ol><p>ephemeris and CIP/CIO, the function iauApci can be used instead    of the present function.</p><ol><li>This is one of several functions that inserts into the astrom</li></ol><p>structure star-independent parameters needed for the chain of    astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and    portions of the transformation chain:</p><pre><code class="language-none">     functions         observer        transformation

  iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS
  iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS
  iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed
  iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS
  iauAper iauAper13    terrestrial     update Earth rotation
  iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed</code></pre><p>Those with names ending in &quot;13&quot; use contemporary SOFA models to    compute the various ephemerides.  The others accept ephemerides    supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion,    parallax, light deflection, and aberration.  From GCRS to CIRS    comprises frame bias and precession-nutation.  From CIRS to    observed takes account of Earth rotation, polar motion, diurnal    aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS    transformation), and atmospheric refraction.</p><ol><li>The context structure astrom produced by this function is used by</li></ol><p>iauAtciq* and iauAticq*.</p><p>Called:    iauEpv00     Earth position and velocity    iauPnm06a    classical NPB matrix, IAU 2006/2000A    iauBpn2xy    extract CIP X,Y coordinates from NPB matrix    iauS06       the CIO locator s, given X,Y, IAU 2006    iauApci      astrometry parameters, ICRS-CIRS    iauEors      equation of the origins, given NPB matrix and s</p><p>This revision:   2013 October 9</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAper-Tuple{Real,iauASTROM}" href="#SOFA.iauAper-Tuple{Real,iauASTROM}"><code>SOFA.iauAper</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>In the star-independent astrometry parameters, update only the Earth rotation angle, supplied by the caller explicitly.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    theta   double      Earth rotation angle (radians, Note 2)    astrom  iauASTROM*  star-independent astrometry parameters:       pmt    double       not used       eb     double[3]    not used       eh     double[3]    not used       em     double       not used       v      double[3]    not used       bm1    double       not used       bpn    double[3][3] not used       along  double       longitude + s&#39; (radians)       xpl    double       not used       ypl    double       not used       sphi   double       not used       cphi   double       not used       diurab double       not used       eral   double       not used       refa   double       not used       refb   double       not used</p><p>Returned:    astrom  iauASTROM*  star-independent astrometry parameters:       pmt    double       unchanged       eb     double[3]    unchanged       eh     double[3]    unchanged       em     double       unchanged       v      double[3]    unchanged       bm1    double       unchanged       bpn    double[3][3] unchanged       along  double       unchanged       xpl    double       unchanged       ypl    double       unchanged       sphi   double       unchanged       cphi   double       unchanged       diurab double       unchanged       eral   double       &quot;local&quot; Earth rotation angle (radians)       refa   double       unchanged       refb   double       unchanged</p><p>Notes:</p><ol><li>This function exists to enable sidereal-tracking applications to</li></ol><p>avoid wasteful recomputation of the bulk of the astrometry    parameters:  only the Earth rotation is updated.</p><ol><li>For targets expressed as equinox based positions, such as</li></ol><p>classical geocentric apparent (RA,Dec), the supplied theta can be    Greenwich apparent sidereal time rather than Earth rotation    angle.</p><ol><li>The function iauAper13 can be used instead of the present</li></ol><p>function, and starts from UT1 rather than ERA itself.</p><ol><li>This is one of several functions that inserts into the astrom</li></ol><p>structure star-independent parameters needed for the chain of    astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and    portions of the transformation chain:</p><pre><code class="language-none">     functions         observer        transformation

  iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS
  iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS
  iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed
  iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS
  iauAper iauAper13    terrestrial     update Earth rotation
  iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed</code></pre><p>Those with names ending in &quot;13&quot; use contemporary SOFA models to    compute the various ephemerides.  The others accept ephemerides    supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion,    parallax, light deflection, and aberration.  From GCRS to CIRS    comprises frame bias and precession-nutation.  From CIRS to    observed takes account of Earth rotation, polar motion, diurnal    aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS    transformation), and atmospheric refraction.</p><p>This revision:   2013 September 25</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAper13-Tuple{Real,Real,iauASTROM}" href="#SOFA.iauAper13-Tuple{Real,Real,iauASTROM}"><code>SOFA.iauAper13</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>In the star-independent astrometry parameters, update only the Earth rotation angle.  The caller provides UT1, (n.b. not UTC).</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    ut11    double      UT1 as a 2-part...    ut12    double      ...Julian Date (Note 1)    astrom  iauASTROM*  star-independent astrometry parameters:    pmt    double       not used    eb     double[3]    not used    eh     double[3]    not used    em     double       not used    v      double[3]    not used    bm1    double       not used    bpn    double[3][3] not used    along  double       longitude + s&#39; (radians)    xpl    double       not used    ypl    double       not used    sphi   double       not used    cphi   double       not used    diurab double       not used    eral   double       not used    refa   double       not used    refb   double       not used</p><p>Returned:    astrom  iauASTROM*  star-independent astrometry parameters:    pmt    double       unchanged    eb     double[3]    unchanged    eh     double[3]    unchanged    em     double       unchanged    v      double[3]    unchanged    bm1    double       unchanged    bpn    double[3][3] unchanged    along  double       unchanged    xpl    double       unchanged    ypl    double       unchanged    sphi   double       unchanged    cphi   double       unchanged    diurab double       unchanged    eral   double       &quot;local&quot; Earth rotation angle (radians)    refa   double       unchanged    refb   double       unchanged</p><p>Notes:</p><ol><li><p>The UT1 date (n.b. not UTC) ut11+ut12 is a Julian Date, apportioned in any convenient way between the arguments ut11 and ut12.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="language-none">  ut11           ut12</code></pre><p>2450123.7           0.0       (JD method)    2451545.0       -1421.3       (J2000 method)    2400000.5       50123.2       (MJD method)    2450123.5           0.2       (date &amp; time method)</p><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  The date &amp; time method is best matched to the algorithm used:  maximum precision is delivered when the ut11 argument is for 0hrs UT1 on the day in question and the ut12 argument lies in the range 0 to 1, or vice versa.</p></li><li><p>If the caller wishes to provide the Earth rotation angle itself, the function iauAper can be used instead.  One use of this technique is to substitute Greenwich apparent sidereal time and thereby to support equinox based transformations directly.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="language-none">  functions         observer        transformation</code></pre><p>iauApcg iauApcg13    geocentric      ICRS &lt;-&gt; GCRS    iauApci iauApci13    terrestrial     ICRS &lt;-&gt; CIRS    iauApco iauApco13    terrestrial     ICRS &lt;-&gt; observed    iauApcs iauApcs13    space           ICRS &lt;-&gt; GCRS    iauAper iauAper13    terrestrial     update Earth rotation    iauApio iauApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary SOFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li></ol><p>Called:    iauAper      astrometry parameters: update ERA    iauEra00     Earth rotation angle, IAU 2000</p><p>This revision:   2013 September 25</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SOFA.iauAtciqz-Tuple{Real,Real,iauASTROM}" href="#SOFA.iauAtciqz-Tuple{Real,Real,iauASTROM}"><code>SOFA.iauAtciqz</code></a> — <span class="docstring-category">Method</span>.</div><div><div><p>Quick ICRS to CIRS transformation, given precomputed star- independent astrometry parameters, and assuming zero parallax and proper motion.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are to be transformed for one date.  The star-independent parameters can be obtained by calling one of the functions iauApci[13], iauApcg[13], iauApco[13] or iauApcs[13].</p><p>The corresponding function for the case of non-zero parallax and proper motion is iauAtciq.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p>Given:    rc,dc  double     ICRS astrometric RA,Dec (radians)    astrom iauASTROM* star-independent astrometry parameters:       pmt    double       PM time interval (SSB, Julian years)       eb     double[3]    SSB to observer (vector, au)       eh     double[3]    Sun to observer (unit vector)       em     double       distance from Sun to observer (au)       v      double[3]    barycentric observer velocity (vector, c)       bm1    double       sqrt(1-|v|^2): reciprocal of Lorenz factor       bpn    double[3][3] bias-precession-nutation matrix       along  double       longitude + s&#39; (radians)       xpl    double       polar motion xp wrt local meridian (radians)       ypl    double       polar motion yp wrt local meridian (radians)       sphi   double       sine of geodetic latitude       cphi   double       cosine of geodetic latitude       diurab double       magnitude of diurnal aberration vector       eral   double       &quot;local&quot; Earth rotation angle (radians)       refa   double       refraction constant A (radians)       refb   double       refraction constant B (radians)</p><p>Returned:    ri,di  double     CIRS RA,Dec (radians)</p><p>Note:</p><p>All the vectors are with respect to BCRS axes.</p><p>References:</p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to    the Astronomical Almanac, 3rd ed., University Science Books    (2013).</p><p>Klioner, Sergei A., &quot;A practical relativistic model for micro-    arcsecond astrometry in space&quot;, Astr. J. 125, 1580-1597 (2003).</p><p>Called:    iauS2c       spherical coordinates to unit vector    iauLdsun     light deflection due to Sun    iauAb        stellar aberration    iauRxp       product of r-matrix and p-vector    iauC2s       p-vector to spherical    iauAnp       normalize angle into range +/- pi</p><p>This revision:   2013 October 9</p><p>SOFA release 2018-01-30</p><p>Copyright (C) 2018 IAU SOFA Board.  See notes at end.</p></div></div></section><footer><hr/></footer></article></body></html>
